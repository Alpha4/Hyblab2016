<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Radios associatives - Pays de la Loire</title>
		<meta name="author" content="Radio Stars" />
		<meta name="description" content="Presentation des radios associatives de la FRAP" />



		<link rel="stylesheet" type="text/css" href="javascript.fullPage.css" />
		<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans" />
		<link rel="stylesheet" type="text/css" href="test_fullpage.css">



        <script src="jquery-1.12.0.min.js"></script>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

        <script src="d3.min.js"></script>

        <script src="jquery.vmap.js"></script>

        <script src="jquerysvg/jquery.svg.js"></script>

        <script src="map_pays_de_la_loire3.js"></script>	


		<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.4/d3.min.js"></script>
		<script src="d3pie.min.js"></script>

		<script>
			window.addEventListener('load', function () {

				map1 = $(document).ready(function () {
					$('#bigmap').vectorMap({
						map:'pays_de_la_loire2',
						backgroundColor: 'none',
						color:'#003f4e',
						selectedColor:'#003f4e',
						hoverColor:'#006f7e',
						series:{
							regions:[{
								attribute:'fill', 
							}]
						}, 
					});

					//map.series.regions[0].setValues("#179fae");

					$('#map').css("background-color","rgba(0,0,0,0)");
					//$('path g svg p div').attr("fill","#179fae");

					
				});
			});
		</script>
		
		<script>
			window.addEventListener('load', function () {

				map1 = $(document).ready(function () {
					$('#map').vectorMap({
						map:'pays_de_la_loire',
						backgroundColor: 'none',
						colors:{
							"FR-44":'#179fae',
							"FR-85":'#179fae',
							"FR-49":'#179fae',
							"FR-72":'#179fae',
							"FR-53":'#179fae',
						},
						series:{
							regions:[{
								attribute:'fill', 
							}]
						},
						onRegionSelected: function(){
						}   
					});

					//map.series.regions[0].setValues("#179fae");

					$('#map').css("background-color","rgba(0,0,0,0)");
					//$('path g svg p div').attr("fill","#179fae");

					
				});
			});
		</script>

		<script>
			window.addEventListener('load', function () {
				
				
                var map = document.getElementById('map');
                map.firstChild.setAttribute("id", "pdll");
                var markersContainer = d3.select("#pdll").append("g");

                var pdll = document.getElementById('pdll');
                pdll.firstChild.setAttribute("id", "carte");
                pdll.firstChild.nextSibling.setAttribute("id", "points");

                //d3.select("#carte").selectAll("path").attr("fill","#179fae");

				//document.getElementById("carte").setAttribute("transform","scale(1), translate(0,0)");

				var jsonDptInfo = [
					{"n":"Vendee","r":5,"a":6,"s":4,"b":62,"sc":9},				
					{"n":"Loire Atlantique","r":3,"a":4,"s":3,"b":58,"sc":5},
					{"n":"Maine et Loire","r":4,"a":2,"s":6,"b":53,"sc":2},
					{"n":"Sarthe","r":2,"a":4,"s":2,"b":65,"sc":0},
					{"n":"Mayenne","r":8,"a":3,"s":5,"b":50,"sc":7},

				]

				var dpt = d3.select("#carte").selectAll("path")
										  .data(jsonDptInfo);
				var info = d3.select("#infodpt");
				
				dpt.on('click', function (d){
					info.style("visibility" ,"visible");
					info.html("<p class='titre'>" + d.n + "</p><p>Radios : " + d.r + "</p><p>Antennes : " + d.a + "</p><p>Salaries : " + d.s + "</p><p>Benevoles : " + d.b + "</p><p>Service Civique : " + d.sc + "</p>");
				});


				var jsonMarker = [
					{"x":560,"y":180,"r":3.5,"c":"white","texte":"Radio 1"},
					{"x":450,"y":282,"r":3.5,"c":"white","texte":"Radio 2"},
					{"x":200,"y":300,"r":3.5,"c":"white","texte":"<p>Prun'</p><p>Une radio étudiante Nantaise<p>"}

				]

				var markers = markersContainer.selectAll("circle")
													.data(jsonMarker)
													.enter()
													.append("circle");

				var div = d3.select("body")
							.append("div")
							.attr("class", "tooltip");

				var markerAttributes = markers
                       .attr("cx", function (d) {return d.x;})
                       .attr("cy", function (d) {return d.y;})
                       .attr("r", function (d) {return d.r; })
                       .style("fill",function (d) {return d.c;})
                       .on("mouseover", function (d){
                       		div.html(d.texte)
                       		   .style("left",(d3.event.pageX) + "px")
                       		   .style("top",(d3.event.pageY+10) + "px")
                       		   .style("visibility","visible");
                       })
                       .on("mouseout", function (d){
                       		div.style("visibility","hidden");
                       });
			});
		</script>

		<script>
			window.addEventListener('load',function () {
				
				var pie = new d3pie("pieChart", {
					/*"header": {
						"title": {
							"fontSize": 34,
							"font": "courier"
						},
						"subtitle": {
							"color": "#999999",
							"fontSize": 10,
							"font": "courier"
						},
						"titleSubtitlePadding": 10
					},
					"footer": {
						"color": "#999999",
						"fontSize": 10,
						"font": "open sans",
						"location": "bottom-left"
					},*/
					"size": {
						"canvasWidth": 300,
						"pieInnerRadius": "64%",
						"pieOuterRadius": "66%"
					},
					"data": {
						"sortOrder": "label-desc",
						"content": [
							{
								"label": "Subventions",
								"value": 68,
								"color": "#ea0000"
							},
							{
								"label": "Aides à l'emploi",
								"value": 10,
								"color": "#ff00f8"
							},
							{
								"label": "Publicité",
								"value": 7,
								"color": "#1000ff"
							},
							{
								"label": "Evenements",
								"value": 2,
								"color": "#00ff23"
							},
							{
								"label": "Cotisations et dons ",
								"value": 2,
								"color": "#00f8ff"
							},
							{
								"label": "Autre",
								"value": 20,
								"color": "#ff5f00"
							}
						]
					},
					"labels": {
						"outer": {
							"format": "none",
							"pieDistance": 20
						},
						"inner": {
							"format": "none"
						},
						"mainLabel": {
							"fontSize": 11
						},
						"percentage": {
							"color": "#999999",
							"fontSize": 11,
							"decimalPlaces": 0
						},
						"value": {
							"color": "#cccc43",
							"fontSize": 11
						},
						"lines": {
							"enabled": true,
							"color": "#777777"
						},
						"truncation": {
							"enabled": true
						}
					},
					"tooltips": {
						"enabled": true,
						"type": "placeholder",
						"string": "{label}: {value}, {percentage}%",
						"styles": {
							"backgroundOpacity": 0.61
						}
					},
					"effects": {
						"pullOutSegmentOnClick": {
							"effect": "linear",
							"speed": 400,
							"size": 8
						}
					},
					"misc": {
						"colors": {
							"segmentStroke": "#000000"
						}
					},
					"callbacks":{
						onClickSegment: function (info){
							console.log(info);
							
							if (!info.expanded) {
								$("#pieSection").css("visibility", "visible")
								$("#pieSection").html(info.data.value);
							} else {
								$("#pieSection").css("visibility", "hidden");
							}
						}
					}
				});


				/*pie = d3.select("#pieChart").select("svg");
				pie.attr("height",300)*/
				//x = document.getElementsByClassName("p0_pieChart");
				//console.log(x);

				//.setAttribute("transform","scale(1), translate(150,150)");

				
				//document.getElementById("pie").setAttribute("transform","scale(1), translate(0,0)");

			});
		</script>
	</head>

	<body>
		<div id="fullpage">
			<div class="section " id="section0">
				<div class="heading">
					<h1>LES RADIOS LOCALES</h1>
					<p>Radios associatives</p>
					<form>
						<input type="button" name="section 2" value="Vers la section 2" onclick="self.location.href='file:///D:/COURS/4A/Web/Hyblab/Hyblab2016/la_frap/test_fullpage.html#secondPage'">
					</form>
				</div>
			</div>
			<div class="section " id="section1">
				<div class="content1">

					<div class="leftPart">
						<p id="bigmap" style="width:841.89px;height:595.28px"></p>
        			</div>
        			<div class="rightPart">
        				
        			</div>
				</div>
			</div>
			
			<div class="section " id="section2">
				<div class="content2">

					<div class="leftPart">
						<p id="map" style="width:419.037px;height:407.543px"></p>
        			</div>
        			<div class="rightPart">
        				<p id="infodpt"></p>
        				<div id="pieChart">
						</div>	
						<div id="pieInfo">
							<p id="pieSection"></p>
						</div>
        			</div>
				</div>
			</div>
		</div>





		


		<script src="javascript.fullPage.js"></script>
		<script>
			fullpage.initialize('#fullpage', {
				anchors: ['firstPage', 'secondPage'],
				menu: '#menu',
				css3:true
			});

		</script>
		<script>
			window.addEventListener('load', function () {
				x = document.getElementsByClassName("p0_pieChart");
				console.log(x);
			});
				
			

		</script>
	</body>
</html>
